
---

# üîπ Unidad 3.1 ‚Äì Manejo de ficheros: lectura, escritura y manejo de excepciones

---

## üéØ Objetivos de aprendizaje

* Comprender qu√© es un fichero y por qu√© se usa en programaci√≥n.
* Diferenciar entre ficheros de texto y binarios.
* Aprender a abrir, leer y escribir ficheros en Python.
* Conocer los modos de apertura (`r`, `w`, `a`, `b`).
* Usar la instrucci√≥n `with` para asegurar el cierre correcto de ficheros.
* Manejar excepciones comunes (`FileNotFoundError`, `PermissionError`).

---

## üìö Explicaci√≥n te√≥rica

Un **fichero** es un recurso externo que permite **guardar datos de forma persistente** en el disco, m√°s all√° de la ejecuci√≥n de un programa.

En Python, se utiliza la funci√≥n:

```python
open(nombre, modo, encoding)
```

### 1. Modos de apertura

Usaremos siempre variables para indicar el modo:

* `modo = "r"` ‚Üí **lectura** (error si no existe).
* `modo = "w"` ‚Üí **escritura** (borra el contenido si existe).
* `modo = "a"` ‚Üí **anexar** (escribe al final, sin borrar).
* `modo = "rb" / "wb"` ‚Üí **lectura/escritura en binario**.

> Recomendaci√≥n: usar `encoding="utf-8"` al trabajar con texto.

---

### 2. Lectura de ficheros

* `.read()` ‚Üí lee todo el contenido.
* `.readline()` ‚Üí lee una sola l√≠nea.
* `.readlines()` ‚Üí devuelve todas las l√≠neas en una lista.
* Iterar con `for` ‚Üí lee l√≠nea por l√≠nea de forma eficiente.

Ejemplo:

```python
archivo = "poema.txt"
modo = "r"
encoding = "utf-8"

with open(archivo, modo, encoding=encoding) as f:
    for linea in f:
        print(linea.strip())
```

---

### 3. Escritura de ficheros

* `"w"` sobrescribe el archivo.
* `"a"` a√±ade contenido al final.

Ejemplo:

```python
archivo = "notas.txt"
modo = "a"  # anexar
encoding = "utf-8"

with open(archivo, modo, encoding=encoding) as f:
    f.write("Nueva nota a√±adida\n")
```

---

### 4. Uso de `with`

El bloque `with` asegura que el archivo se cierre autom√°ticamente:

```python
archivo = "texto.txt"
modo = "r"
encoding = "utf-8"

with open(archivo, modo, encoding=encoding) as f:
    contenido = f.read()

print("¬øArchivo cerrado?", f.closed)  # True
```

---

### 5. Manejo de excepciones

Errores comunes al trabajar con ficheros:

* `FileNotFoundError` ‚Üí el archivo no existe.
* `PermissionError` ‚Üí no se tienen permisos.

Ejemplo con `try/except`:

```python
archivo = "inexistente.txt"
modo = "r"
encoding = "utf-8"

try:
    with open(archivo, modo, encoding=encoding) as f:
        print(f.read())
except FileNotFoundError:
    print("‚ùå El archivo no existe.")
except PermissionError:
    print("‚ùå No tienes permisos para acceder al archivo.")
```

---

## üíª Ejemplos pr√°cticos

Ejemplo 1 ‚Äî Leer todo el contenido:

```python
archivo = "poema.txt"
modo = "r"
encoding = "utf-8"

with open(archivo, modo, encoding=encoding) as f:
    contenido = f.read()
    print(contenido)
```

Ejemplo 2 ‚Äî Escribir un archivo desde cero:

```python
archivo = "salida.txt"
modo = "w"
encoding = "utf-8"

with open(archivo, modo, encoding=encoding) as f:
    f.write("Primera l√≠nea\n")
    f.write("Segunda l√≠nea\n")
```

Ejemplo 3 ‚Äî Lectura l√≠nea a l√≠nea con manejo de errores:

```python
archivo = "datos.txt"
modo = "r"
encoding = "utf-8"

try:
    with open(archivo, modo, encoding=encoding) as f:
        for linea in f:
            print(linea.strip())
except FileNotFoundError:
    print("No se encontr√≥ el archivo.")
```

---

## üìù Actividad guiada ‚Äî `lectura_escritura.py`

1. Crea un archivo llamado `mi_archivo.txt` y escribe 3 frases (una por l√≠nea).
2. Vuelve a abrirlo en modo lectura y muestra:

   * Todo el contenido de golpe.
   * La primera l√≠nea con `.readline()`.
   * Todas las l√≠neas en una lista con `.readlines()`.
3. Abre el archivo en modo anexar y agrega una nueva l√≠nea.

üëâ **Objetivo:** practicar `read`, `readline`, `readlines`, `write` y el uso de `modo` como variable.

---

## üìù Reto a entregar ‚Äî `gestor_notas.py`

Crea un programa de consola que gestione un archivo de notas (`notas.txt`).

### Requisitos:

1. **Al iniciar:**

   * Si el archivo existe ‚Üí mostrar todas las notas numeradas (ej: `1. Comprar pan`).
   * Si no existe ‚Üí mostrar un mensaje y crearlo vac√≠o autom√°ticamente.

2. **Men√∫ de opciones:**
   El usuario debe poder elegir entre:

   * `1. Ver notas` ‚Üí muestra todas las notas guardadas.
   * `2. A√±adir nota` ‚Üí pide un texto y lo a√±ade al final del archivo.
   * `3. Eliminar nota` ‚Üí pide el n√∫mero de la nota y la elimina del archivo.
   * `4. Salir`.

3. **Control de errores:**

   * Manejar `FileNotFoundError` y `PermissionError`.
   * Manejar errores de entrada del usuario (ej: si introduce un n√∫mero inv√°lido al eliminar).

4. **Detalles t√©cnicos:**

   * Usa siempre una variable `modo` para abrir los ficheros (`"r"`, `"a"`, `"w"`).
   * Usa `with open(...)` para asegurar el cierre autom√°tico.
   * Documenta el programa con un docstring al inicio y comentarios en las funciones.

---

### Ejemplo de ejecuci√≥n:

```
üìì Gestor de Notas
Archivo encontrado: notas.txt

Notas actuales:
1. Comprar pan
2. Estudiar Python

--- Men√∫ ---
1. Ver notas
2. A√±adir nota
3. Eliminar nota
4. Salir
Elige una opci√≥n: 2

Escribe la nueva nota: Hacer ejercicio
‚úÖ Nota guardada con √©xito.

--- Men√∫ ---
1. Ver notas
2. A√±adir nota
3. Eliminar nota
4. Salir
Elige una opci√≥n: 3

N√∫mero de nota a eliminar: 1
‚úÖ Nota eliminada correctamente.

--- Men√∫ ---
1. Ver notas
2. A√±adir nota
3. Eliminar nota
4. Salir
Elige una opci√≥n: 4

üëã ¬°Hasta la pr√≥xima!
```

---

üëâ De esta forma, el alumno practica:

* Lectura completa de archivos.
* Escritura y anexado.
* Reescritura de archivos (al eliminar notas).
* Uso de variables `modo`.
* Manejo de excepciones reales.
* Un mini-programa con men√∫ que combina todo lo visto en la unidad.

---

## üìå Relaci√≥n con RA

* **RA3.ce1 (a):** se han manipulado ficheros en Python, comprendiendo los modos de apertura y su uso.
* **RA3.ce2 (b):** se han aplicado t√©cnicas de control de errores para mejorar la robustez del programa.

---

